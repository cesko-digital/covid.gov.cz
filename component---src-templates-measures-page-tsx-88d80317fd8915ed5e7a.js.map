{"version":3,"sources":["webpack:///./src/components/measure-detail/measure-detail.module.scss","webpack:///./src/components/measure-detail/measure-detail.tsx","webpack:///./src/components/measure-detail/getCurrentMeasureVersion.util.ts","webpack:///./src/components/client-only/client-only.tsx","webpack:///./src/templates/measures/page.tsx"],"names":["module","exports","measure","t","useTranslation","hasRegion","Boolean","hash","useLocation","currentVersion","date","dateVersionHash","sortedFutureVersions","v","a","b","futureVersionToDisplayIndex","versionToDisplay","nextVersion","nextVersionFrom","nextVersionDate","isDisplayedVersionCurrent","nextVersionHash","getCurrentMeasureVersion","useState","hasMounted","setHasMounted","useEffect","useHasMounted","hasSourceLink","hasTimeConstraint","hasUpdateWarning","title","subtitle","lastUpdated","processedContent","beforeContent","key","className","variant","reactStringReplace","href","datetime","displayOnCzDayCase","displayTime","suffix","classNames","styles","regions","region","displayShortDay","validFrom","validTo","valid_to","to","uri","isMobile","last_updated","query","data","pageContext","relatedMeasures","id","name","path","isActive","theme","hasTransparentHeader","showSearchInHeader","showBackgroundImage","description","pagePath","htmlLanguage","langcode","datePublished","dateModified","langCode","isBlogPost","breadcrumbItems","url","alias","items","menu","linkBack","slug","titleIconCode","code","hideMenuOnMobile"],"mappings":"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","file":"component---src-templates-measures-page-tsx-88d80317fd8915ed5e7a.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"measureDetailMobile\":\"measure-detail-module--measureDetailMobile--MhAEC\",\"measureDetailDesktop\":\"measure-detail-module--measureDetailDesktop--1UHQV\"};","import React from 'react';\nimport reactStringReplace from 'react-string-replace';\n\nimport Link from '@/components/link';\nimport { IMeasureDetailFragment } from '@graphql-types';\nimport { useLocation } from '@reach/router';\nimport { graphql } from 'gatsby';\nimport TopicDetail from '../topic-detail';\nimport { useTranslation } from '../i18n';\nimport { RegionsMarker, TimeMarker } from '../marker';\nimport LastUpdate from '../last-update';\nimport { UpdateWarning } from '../update-warning/update-warning';\nimport Time from '../time';\nimport { getCurrentMeasureVersion } from './getCurrentMeasureVersion.util';\nimport { useHasMounted } from '../client-only';\nimport classNames from 'classnames';\nimport styles from './measure-detail.module.scss';\n\ninterface IProps {\n  measure: IMeasureDetailFragment;\n}\n\nconst MeasureDetail: React.FC<IProps> = ({ measure }) => {\n  const { t } = useTranslation();\n  const hasRegion = Boolean(measure?.relationships?.region?.length);\n  const { hash } = useLocation();\n  const hasMounted = useHasMounted();\n  const {\n    versionToDisplay,\n    isDisplayedVersionCurrent,\n    nextVersionFrom,\n    nextVersionHash,\n  } = getCurrentMeasureVersion(hasMounted ? hash : '', measure);\n  const hasSourceLink = Boolean(versionToDisplay.source);\n  const hasTimeConstraint = Boolean(\n    versionToDisplay?.valid_from || versionToDisplay?.valid_to,\n  );\n  const hasUpdateWarning = Boolean(\n    !isDisplayedVersionCurrent || nextVersionFrom,\n  );\n\n  return (\n    <>\n      <TopicDetail\n        title={measure.title}\n        subtitle={measure.norm}\n        lastUpdated={measure?.last_updated}\n        processedContent={versionToDisplay?.content?.processed}\n        beforeContent={\n          <>\n            {!isDisplayedVersionCurrent && (\n              <UpdateWarning\n                key={`${measure.path.alias}-current`}\n                className=\"position-relative\"\n                variant=\"alert\"\n                title={reactStringReplace(\n                  reactStringReplace(\n                    t('measure_valid_from'),\n                    /{{(.*)}}/,\n                    (match) => (\n                      <a\n                        href=\"#\"\n                        className=\"stretched-link\"\n                        key=\"current-version-link\"\n                      >\n                        {match}\n                      </a>\n                    ),\n                  ),\n                  '{date}',\n                  () => (\n                    <Time\n                      datetime={versionToDisplay?.valid_from}\n                      displayOnCzDayCase={false}\n                      displayTime={true}\n                      suffix=\"\"\n                      key=\"current-version-time\"\n                    />\n                  ),\n                )}\n              />\n            )}\n            {nextVersionFrom && (\n              <UpdateWarning\n                key={`${measure.path.alias}-future`}\n                className=\"position-relative\"\n                variant=\"info\"\n                title={reactStringReplace(\n                  reactStringReplace(\n                    t('measure_changes'),\n                    /{{(.*)}}/,\n                    (match) => (\n                      <a\n                        href={nextVersionHash}\n                        className=\"stretched-link\"\n                        key=\"next-version-link\"\n                      >\n                        {match}\n                      </a>\n                    ),\n                  ),\n                  '{date}',\n                  () => (\n                    <Time\n                      datetime={nextVersionFrom}\n                      displayOnCzDayCase={true}\n                      displayTime={true}\n                      suffix=\"\"\n                      key=\"next-version-time\"\n                    />\n                  ),\n                )}\n              />\n            )}\n            {hasUpdateWarning && <hr />}\n            <div\n              className={classNames(\n                styles.measureDetailMobile,\n                'bg-white mb-3',\n              )}\n            >\n              {hasRegion && (\n                <RegionsMarker regions={measure?.relationships?.region} />\n              )}\n              {hasTimeConstraint && (\n                <TimeMarker\n                  displayTime\n                  displayShortDay={true}\n                  validFrom={versionToDisplay?.valid_from}\n                  validTo={versionToDisplay?.valid_to}\n                />\n              )}\n              <hr />\n            </div>\n            <div\n              className={classNames(\n                styles.measureDetailDesktop,\n                'bg-white mb-3',\n              )}\n            >\n              {hasRegion && (\n                <RegionsMarker regions={measure?.relationships?.region} />\n              )}\n              {hasTimeConstraint && (\n                <TimeMarker\n                  displayTime\n                  displayShortDay={false}\n                  validFrom={versionToDisplay?.valid_from}\n                  validTo={versionToDisplay?.valid_to}\n                />\n              )}\n              <hr />\n            </div>\n          </>\n        }\n      />\n      <div className=\"bg-white mb-3 pb-2 pb-md-0 px-2 px-md-3\">\n        {hasSourceLink && (\n          <div className=\"pt-2\">\n            <hr />\n            <h3 className=\"mb-1 color-blue-dark\">{t('related')}</h3>\n            <div>\n              <Link\n                className=\"color-blue mb-1\"\n                to={versionToDisplay.source.uri}\n              >\n                {versionToDisplay.source.title}\n              </Link>\n            </div>\n          </div>\n        )}\n        <LastUpdate isMobile lastUpdated={measure?.last_updated} />\n      </div>\n    </>\n  );\n};\n\nexport const query = graphql`\n  fragment MeasureDetail on measure {\n    title\n    norm\n    content: description {\n      processed\n    }\n    source {\n      uri\n      title\n    }\n    relationships {\n      region {\n        name\n        drupal_internal__tid\n      }\n      situation_type: measure_type {\n        name\n        path {\n          alias\n        }\n      }\n      related_situations: situation {\n        title\n        path {\n          alias\n          langcode\n        }\n      }\n      versions {\n        content {\n          processed\n        }\n        valid_from\n        valid_to\n        source {\n          uri\n          title\n        }\n      }\n    }\n    path {\n      alias\n    }\n    changed\n    valid_from\n    valid_to\n    last_updated\n  }\n`;\n\nexport default MeasureDetail;\n","import { IMeasureDetailFragment } from '@graphql-types';\n\nexport const getCurrentMeasureVersion = (\n  dateVersionHash: string,\n  measure: IMeasureDetailFragment,\n) => {\n  const currentVersion = measure;\n  const date = dateVersionHash.replace('#', '');\n  const sortedFutureVersions =\n    measure?.relationships?.versions\n      .filter((v) => v.valid_from > currentVersion?.valid_from)\n      .sort((a, b) => (a.valid_from > b.valid_from ? 1 : -1)) ?? [];\n\n  const futureVersionToDisplayIndex = sortedFutureVersions.findIndex(\n    (v) => v.valid_from.replace(/T.*/, '') === date,\n  );\n  const futureVersion = sortedFutureVersions[futureVersionToDisplayIndex];\n  const versionToDisplay = futureVersion || currentVersion;\n\n  const nextVersion = sortedFutureVersions[futureVersionToDisplayIndex + 1];\n  const nextVersionFrom = nextVersion ? nextVersion.valid_from : '';\n  const nextVersionDate = nextVersionFrom.replace(/T.*/, '');\n  const nextVersionHash = nextVersionDate ? `#${nextVersionDate}` : undefined;\n  const isDisplayedVersionCurrent = futureVersionToDisplayIndex === -1;\n\n  return {\n    versionToDisplay,\n    isDisplayedVersionCurrent,\n    nextVersionFrom,\n    nextVersionHash,\n  };\n};\n","import { useState, useEffect } from 'react';\n\nexport const useHasMounted = () => {\n  const [hasMounted, setHasMounted] = useState(false);\n  useEffect(() => {\n    setHasMounted(true);\n  }, []);\n  return hasMounted;\n};\n","import React from 'react';\nimport { graphql } from 'gatsby';\nimport { IMeasurePageQuery, ISitePageContext } from 'graphql-types';\nimport { SchemaComp } from '@/components/schema/schema';\nimport { SEO as Seo } from 'gatsby-plugin-seo';\nimport Layout from '@/layouts/default-layout';\nimport MeasureDetail from '@/components/measure-detail';\nimport DesktopLeftMenuLayout from '@/layouts/desktop-left-menu-layout';\nimport CategoryItemList from '@/components/category-item-list';\nimport Container from '@/components/container';\nimport Breadcrumb from '@/components/breadcrumb';\nimport { useTranslation } from '@/components/i18n';\n\ninterface IProps {\n  data: IMeasurePageQuery;\n  pageContext: ISitePageContext;\n}\n\nconst Page: React.FC<IProps> = ({ data, pageContext }) => {\n  const { t } = useTranslation();\n  const relatedMeasures: React.ComponentProps<\n    typeof CategoryItemList\n  >['items'] = data.measureType.relationships.measure.map((measure) => ({\n    id: measure.id,\n    name: measure.title,\n    path: measure.path.alias,\n    isActive: measure.path.alias === pageContext.slug,\n    theme: 'white',\n  }));\n\n  return (\n    <Layout\n      pageContext={pageContext}\n      hasTransparentHeader={false}\n      showSearchInHeader\n      showBackgroundImage={false}\n    >\n      <Seo\n        title={data.measure.title}\n        description={\n          data.measure.meta_description || t('current_measures_overview_meta')\n        }\n        pagePath={data.measure.path.alias}\n        htmlLanguage={data.measure.langcode}\n      />\n      <SchemaComp\n        datePublished={\n          data.measure.valid_from\n            ? data.measure.valid_from\n            : data.measure.created\n        }\n        dateModified={data.measure.changed}\n        title={data.measure.title}\n        langCode={data.measure.langcode}\n        isBlogPost\n        description={data.measure.meta_description}\n        breadcrumbItems={[\n          { title: t('home'), url: '/' },\n          {\n            title: t('current_measures'),\n            url: t(`slug_measures`),\n          },\n          {\n            title: data.measure.relationships?.situation_type?.name,\n            url: data.measure.relationships?.situation_type?.path?.alias,\n          },\n          data.measure.title,\n        ]}\n      />\n      <Container>\n        <div className=\"pt-1 pb-1 pt-md-3 pb-md-3\">\n          <Breadcrumb\n            items={[\n              { title: t('home'), url: '/' },\n              {\n                title: t('current_measures'),\n                url: t(`slug_measures`),\n              },\n              {\n                title: data.measure.relationships?.measure_type?.name,\n                url: data.measure.relationships?.measure_type?.path?.alias,\n              },\n              data.measure.title,\n            ]}\n          />\n        </div>\n        <DesktopLeftMenuLayout\n          theme=\"white\"\n          menu={\n            <CategoryItemList\n              theme=\"white\"\n              items={relatedMeasures}\n              linkBack={{\n                slug: pageContext.listSlug,\n                title: t('current_measures'),\n              }}\n              title={data.measureType.name}\n              titleIconCode={data.measureType?.relationships?.icon?.code}\n            />\n          }\n          hideMenuOnMobile\n        >\n          <MeasureDetail measure={data.measure} />\n        </DesktopLeftMenuLayout>\n      </Container>\n    </Layout>\n  );\n};\nexport default Page;\n\nexport const query = graphql`\n  query MeasurePage($slug: String!, $listSlug: String!, $langCode: String!) {\n    measure(path: { alias: { eq: $slug }, langcode: { eq: $langCode } }) {\n      title\n      meta_description\n      content: description {\n        processed\n      }\n      path {\n        alias\n      }\n      langcode\n      valid_from\n      created\n      relationships {\n        region {\n          name\n          drupal_internal__tid\n        }\n        measure_type {\n          name\n          path {\n            alias\n          }\n        }\n        related_situations: situation {\n          title\n        }\n      }\n      ...MeasureDetail\n    }\n    measureType(path: { alias: { eq: $listSlug } }) {\n      name\n      path {\n        alias\n      }\n      relationships {\n        icon {\n          code\n        }\n        measure {\n          id\n          title\n          path {\n            alias\n          }\n        }\n      }\n    }\n  }\n`;\n"],"sourceRoot":""}